{"ast":null,"code":"import React,{useState,useEffect,useRef}from'react';import Modal from'react-modal';import{Html5QrcodeScanner}from'html5-qrcode';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";Modal.setAppElement('#root');const placeholderImages=[{id:1,name:'Card 1',image:'/placeholder1.jpg'},{id:2,name:'Card 2',image:'/placeholder2.jpg'},{id:3,name:'Card 3',image:'/placeholder3.jpg'}];const Chapter1=()=>{const[cardData,setCardData]=useState([...placeholderImages]);const[isModalOpen,setIsModalOpen]=useState(false);const[jsonData,setJsonData]=useState([]);const lastScanTime=useRef(0);const scanDelay=3000;// 3 seconds between scans\nconst scannerRef=useRef(null);const handleScan=data=>{const now=Date.now();if(data&&now-lastScanTime.current>scanDelay){lastScanTime.current=now;try{const parsed=JSON.parse(data);if(!Array.isArray(parsed))throw new Error('QR JSON must be an array');setJsonData(parsed);const updated=cardData.map(card=>{const match=parsed.find(item=>item.id===card.id);return match?{...card,name:match.name,image:match.image}:card;});setCardData(updated);setIsModalOpen(false);// Close modal after scan and update\n}catch(e){console.error('Failed to parse QR code:',e);}}};const handleError=err=>{console.error('QR Reader Error:',err);};useEffect(()=>{if(isModalOpen&&!scannerRef.current){scannerRef.current=new Html5QrcodeScanner('qr-reader',{fps:10,qrbox:250},false);scannerRef.current.render(handleScan,handleError);}return()=>{var _scannerRef$current;(_scannerRef$current=scannerRef.current)===null||_scannerRef$current===void 0?void 0:_scannerRef$current.clear().catch(console.error);scannerRef.current=null;};},[isModalOpen]);return/*#__PURE__*/_jsxs(\"div\",{style:{padding:'2rem'},children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Chapter 1\"}),/*#__PURE__*/_jsx(\"div\",{style:{display:'flex',gap:'1rem'},children:cardData.map((card,index)=>/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"img\",{src:card.image,alt:card.name,width:200,height:200,onClick:()=>setIsModalOpen(true),style:{cursor:'pointer',border:'1px solid #ccc',padding:'0.5rem'}}),/*#__PURE__*/_jsx(\"p\",{children:card.name})]},index))}),/*#__PURE__*/_jsxs(Modal,{isOpen:isModalOpen,onRequestClose:()=>setIsModalOpen(false),contentLabel:\"Scan QR\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Scan QR Code\"}),/*#__PURE__*/_jsx(\"div\",{id:\"qr-reader\",style:{width:'300px',height:'300px'}}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setIsModalOpen(false),children:\"Close\"})]}),jsonData.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'2rem'},children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Scanned Data:\"}),jsonData.map((item,index)=>/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'1rem'},children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"ID: \",item.id]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Name: \",item.name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Image: \",item.image]})]},index))]})]});};export default Chapter1;","map":{"version":3,"names":["React","useState","useEffect","useRef","Modal","Html5QrcodeScanner","jsx","_jsx","jsxs","_jsxs","setAppElement","placeholderImages","id","name","image","Chapter1","cardData","setCardData","isModalOpen","setIsModalOpen","jsonData","setJsonData","lastScanTime","scanDelay","scannerRef","handleScan","data","now","Date","current","parsed","JSON","parse","Array","isArray","Error","updated","map","card","match","find","item","e","console","error","handleError","err","fps","qrbox","render","_scannerRef$current","clear","catch","style","padding","children","display","gap","index","src","alt","width","height","onClick","cursor","border","isOpen","onRequestClose","contentLabel","length","marginTop","marginBottom"],"sources":["/home/fnky/C0de/School/Special-Topics/Blackwood-Mansion/src/components/Chapters/Chapter1.tsx"],"sourcesContent":["import React, { useState, useEffect, useRef } from 'react';\nimport Modal from 'react-modal';\nimport { Html5QrcodeScanner } from 'html5-qrcode';\n\nModal.setAppElement('#root');\n\ninterface Card {\n  id: number;\n  name: string;\n  image: string;\n}\n\nconst placeholderImages: Card[] = [\n  { id: 1, name: 'Card 1', image: '/placeholder1.jpg' },\n  { id: 2, name: 'Card 2', image: '/placeholder2.jpg' },\n  { id: 3, name: 'Card 3', image: '/placeholder3.jpg' },\n];\n\nconst Chapter1: React.FC = () => {\n  const [cardData, setCardData] = useState<Card[]>([...placeholderImages]);\n  const [isModalOpen, setIsModalOpen] = useState(false);\n  const [jsonData, setJsonData] = useState<any[]>([]);\n  const lastScanTime = useRef<number>(0);\n  const scanDelay = 3000; // 3 seconds between scans\n  const scannerRef = useRef<Html5QrcodeScanner | null>(null);\n\n  const handleScan = (data: string | null) => {\n    const now = Date.now();\n    if (data && now - lastScanTime.current > scanDelay) {\n      lastScanTime.current = now;\n      try {\n        const parsed = JSON.parse(data);\n        if (!Array.isArray(parsed)) throw new Error('QR JSON must be an array');\n        setJsonData(parsed);\n\n        const updated = cardData.map(card => {\n          const match = parsed.find((item: any) => item.id === card.id);\n          return match ? { ...card, name: match.name, image: match.image } : card;\n        });\n\n        setCardData(updated);\n        setIsModalOpen(false); // Close modal after scan and update\n      } catch (e) {\n        console.error('Failed to parse QR code:', e);\n      }\n    }\n  };\n\n  const handleError = (err: any) => {\n    console.error('QR Reader Error:', err);\n  };\n\n  useEffect(() => {\n    if (isModalOpen && !scannerRef.current) {\n      scannerRef.current = new Html5QrcodeScanner('qr-reader', { fps: 10, qrbox: 250 }, false);\n      scannerRef.current.render(handleScan, handleError);\n    }\n\n    return () => {\n      scannerRef.current?.clear().catch(console.error);\n      scannerRef.current = null;\n    };\n  }, [isModalOpen]);\n\n  return (\n    <div style={{ padding: '2rem' }}>\n      <h2>Chapter 1</h2>\n\n      <div style={{ display: 'flex', gap: '1rem' }}>\n        {cardData.map((card, index) => (\n          <div key={index}>\n            <img\n              src={card.image}\n              alt={card.name}\n              width={200}\n              height={200}\n              onClick={() => setIsModalOpen(true)}\n              style={{ cursor: 'pointer', border: '1px solid #ccc', padding: '0.5rem' }}\n            />\n            <p>{card.name}</p>\n          </div>\n        ))}\n      </div>\n\n      <Modal isOpen={isModalOpen} onRequestClose={() => setIsModalOpen(false)} contentLabel=\"Scan QR\">\n        <h2>Scan QR Code</h2>\n        <div id=\"qr-reader\" style={{ width: '300px', height: '300px' }} />\n        <button onClick={() => setIsModalOpen(false)}>Close</button>\n      </Modal>\n\n      {jsonData.length > 0 && (\n        <div style={{ marginTop: '2rem' }}>\n          <h3>Scanned Data:</h3>\n          {jsonData.map((item, index) => (\n            <div key={index} style={{ marginBottom: '1rem' }}>\n              <p>ID: {item.id}</p>\n              <p>Name: {item.name}</p>\n              <p>Image: {item.image}</p>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Chapter1;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}